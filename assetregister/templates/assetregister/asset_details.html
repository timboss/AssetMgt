{% extends 'assetregister/base.html' %}

    {% block content %}
    
    <ul class="breadcrumb">
		<li><a href="#">Home</a></li>
		<li><a href="{% url 'asset_list' %}">Assets</a></li>
		<li class="active">Details</li>
	</ul>

    
        <div class="asset">
            
            <h3>{{ asset.asset_description }}
            
            {% if user.is_authenticated %}
                <a class="btn btn-default" href="{% url 'asset_edit' pk=asset.pk %}" title="Edit asset"><span class="glyphicon glyphicon-edit gi-1x"></span></a>
            {% endif %}
            {% if request.user.is_superuser %}
                <a class="btn btn-default" href="{% url 'asset_confirm_delete' pk=asset.pk %}" title="Delete asset"><span class="glyphicon glyphicon-trash gi-1x"></span></a>
            {% endif %}
            
            </h3>
            
            <br />
            
            <p>Asset I.D. {{ asset.asset_id }}</p>

            {% if asset.asset_image_thumbnail%}
                <p><a href="/media/{{ asset.asset_image }}" target="_blank"><img src="/media/{{ asset.asset_image_thumbnail }}"></a></p>
            {% endif %}
            
            {% if asset.asset_details %}
                <p>Asset Details / Notes: {{ asset.asset_details|linebreaks }}</p> <br />
            {% endif %}
            
            {% if asset.asset_manufacturer %}
                <p>Manufacturer: {{ asset.asset_manufacturer }}</p>
            {% endif %}
            
            {% if asset.asset_model %}
                <p>Model: {{ asset.asset_model }}</p>
            {% endif %}
            
            {% if asset.asset_serial_number %}
                <p>Serial Number: {{ asset.asset_serial_number }}</p>
            {% endif %}
            
            {% if asset.asset_status %}
                <p>Current Staus: {{ asset.asset_status}}</p>
            {% endif %}
            
            {% if asset.person_responsible %}
                <p>Person Responsible: {{ asset.person_responsible }}</p>
            {% endif %}
            
            {% if asset.person_responsible_email %}
                <p>Person Responsible Email: <a href="mailto:{{ asset.person_responsible_email }}">{{ asset.person_responsible_email }}</a></p>
            {% endif %}
            
            {% if asset.requires_calibration %}
            	<hr>
                <p>Requires Calibration: <span class="glyphicon glyphicon-ok gi-1x"></span><br />
                	
                
              	<b>Passed Last Calibration: </b>
              	{% if asset.passed_calibration == True %}
              		<span = class="glyphicon glyphicon-ok gi-2x"></span>
              	{% else %}
              		<span = class="glyphicon glyphicon-remove gi-2x"></span>
              	{% endif %}
                
                <div class="panel-group">
					<div class="panel panel-default">
					    <div class="panel-heading">
					      <h4 class="panel-title">
					        <a data-toggle="collapse" href="#collapse1">
					        	<div id="calibration-expand-container">
					        		<div id="calibration-expand-left" align="left">Calibration Records</div>
					        		<div id="calibration-expand-right" align="right"><span class=" glyphicon glyphicon-triangle-bottom gi-1x"></span></div>
					        	</div>
					        </a>
					      </h4>
					    </div>
					    <div id="collapse1" class="panel-collapse collapse">
					    	<div class="panel-body">
					    	
					    	{% if calibrations %}
					    	
					    		<table class="table table-striped">
									<thead>
										<tr>
										    <th>Calibration Description</th>
										    <th>Calibration Date</th>
										    <th>Result</th>
										    <th>Next Calibration Due</th>
										</tr>
									</thead>
									<tbody>
										{% for calibration in calibrations %}
											<tr>
												<td><a href="{% url 'calibration_detail' pk=calibration.calibration_record_id %}">{{ calibration.calibration_description }}</a></td>
												<td>{{ calibration.calibration_date }}</td>
												<td><b>{{ calibration.calibration_outcome }}</b></td>
												<td>{{ calibration.calibration_date_next }}</td>
											</tr>
										{% endfor %}
									</tbody>
								</table>
							{% else %}
								<h4>No calibration records yet :(</h4>
							{% endif %}	
								
					    	</div>
					    	{% if user.is_authenticated %}
						      	<div class="panel-footer">
						      		<a href="{% url 'new_calibration_asset' urlpk=asset.pk %}">Add Calibration Record</a>
						      	</div>
						    {% endif %}
						</div>
					</div>
				</div>
				
				<hr>

            {% endif %}
            
            {% if asset.requires_safety_checks %}
                <p>Requires Safety Checks: <span class="glyphicon glyphicon-ok gi-1x"></span></p>
            {% endif %}
            
            {% if asset.requires_environmental_checks %}
                <p>Requires Environmental Checks: <span class="glyphicon glyphicon-ok gi-1x"></span></p>
            {% endif %}
            
            {% if asset.requires_planned_maintenance %}
                <p>Requires Planned Preventative Maintenance: <span class="glyphicon glyphicon-ok gi-1x"></span>
               	
               	{% if asset.maintenance_records %}
               		<br /><a href="{{ asset.maintenance_records }}" target="_blank">View Maintenance Records</a>
               	{% endif %}
               	
               	</p>
            {% endif %}
            
            {% if asset.asset_value %}
                <p>Value: Â£{{ asset.asset_value }}</p>
            {% endif %}
            
            {% if asset.purchase_order_ref %}
                <p>PO Ref: {{ asset.purchase_order_ref }}</p>
            {% endif %}
            
            {% if asset.funded_by %}
                <p>Funded By: {{ asset.funded_by }}</p>
            {% endif %}
            
            {% if asset.acquired_on %}
                <p>Acquired On: {{ asset.acquired_on }}</p>
            {% endif %}
            
            {% if asset.parent_assets.all %}
            	<hr>
           		<div class="panel-group">
					<div class="panel panel-default">
					    <div class="panel-heading">
					      <h4 class="panel-title">
					        <a data-toggle="collapse" href="#collapse2">
					        	<div id="calibration-expand-container">
					        		<div id="calibration-expand-left" align="left">Related To</div>
					        		<div id="calibration-expand-right" align="right"><span class=" glyphicon glyphicon-triangle-bottom gi-1x"></span></div>
					        	</div>
					        </a>
					      </h4>
					    </div>
					    <div id="collapse2" class="panel-collapse collapse">
					    	<div class="panel-body">
					    		<table class="table table-striped">
									<thead>
										<tr>
										    <th>Asset I.D.</th>
										    <th>Asset Description</th>
										    <th></th>
										</tr>
									</thead>
									<tbody>
										{% for relative in asset.parent_assets.all %}
											<tr>
												<td><a href="{% url 'asset_detail' pk=relative.asset_id %}">{{ relative.asset_id }}</a></td>
												<td><a href="{% url 'asset_detail' pk=relative.asset_id %}">{{ relative }}</a></td>
												<td><a href="{% url 'asset_detail' pk=relative.asset_id %}"><img src="/media/{{ relative.asset_image_thumbnail }}" width="50%" height="50%"></a></td>
											</tr>
										{% endfor %}
									</tbody>
								</table>
					    	</div>
						</div>
					</div>
				</div>
				<hr>
			{% endif %}
            
            {% if asset.asset_location_building %}
                <p>Location (Building): {{ asset.asset_location_building }}</p>
            {% endif %}
            
            {% if asset.asset_location_room %}
                <p>Location (Room): {{ asset.asset_location_room }}</p>
            {% endif %}
            
            <p>Asset Record Last Edited {{ asset.edited_on }} by {{ asset.edited_by }}</p>
            
            <br /><br />
            
            {% if asset.calibration_instructions %}
                <p><a href="{{ asset.calibration_instructions }}" target="_blank"><span class="glyphicon glyphicon-file gi-1x"></span>  Download Calibration Instructions</a></p>
            {% endif %}    
            
            {% if asset.maintenance_instructions %}
                <p><a href="{{ asset.maintenance_instructions }}" target="_blank"><span class="glyphicon glyphicon-file gi-1x"></span>  Download Maintenance Instructions</a></p>
            {% endif %}
            
            {% if asset.asset_handling_and_storage_instructions %}
                <p><a href="{{ asset.asset_handling_and_storage_instructions }}" target="_blank"><span class="glyphicon glyphicon-file gi-1x"></span>  Download Handling and Storage Instructions</a></p>
            {% endif %}
            
            {% if asset.asset_operating_instructions %}
                <p><a href="{{ asset.asset_operating_instructions }}" target="_blank"><span class="glyphicon glyphicon-file gi-1x"></span>  Download Operating Instructions</a></p>
            {% endif %}            
            
            <br />
            <a href="{% url 'asset_qr' pk=asset.pk %}" target="_blank" onclick="window.open('{% url 'asset_qr' pk=asset.pk %}', 'newwindow', 'width=665, height=310'); return false;"><span class="glyphicon glyphicon-barcode gi-1x"></span>  Generate Large Asset QR Code</a>
            <br />
            <a href="{% url 'asset_qr_small' pk=asset.pk %}" target="_blank" onclick="window.open('{% url 'asset_qr_small' pk=asset.pk %}', 'newwindow2', 'width=130, height=190'); return false;"><span class="glyphicon glyphicon-barcode gi-1x"></span>  Generate Small Asset QR Code</a>
        </div>

    {% endblock %}